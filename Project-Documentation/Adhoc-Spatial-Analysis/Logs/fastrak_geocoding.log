2024-09-13 22:20:04,269 - fastrak_geocoding - INFO - Reading Fastrak data from /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/account_complete_9_12_24.csv
2024-09-13 22:20:11,022 - fastrak_geocoding - INFO - Read 921649 records from Fastrak data
2024-09-13 22:20:11,022 - fastrak_geocoding - INFO - Dropping columns that are blank
2024-09-13 22:20:11,314 - fastrak_geocoding - INFO - Creating required columns for geocoding
2024-09-13 22:20:13,183 - fastrak_geocoding - INFO - Created FULL_ADDRESS column
2024-09-13 22:20:13,465 - fastrak_geocoding - INFO - Dropping 3007 duplicated addresses
2024-09-13 22:20:13,987 - fastrak_geocoding - INFO - Starting batch address geocoding on 918642 records
2024-09-13 22:20:13,987 - fastrak_geocoding - INFO - Local geocoded data file exists at /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/bay_area_fastrak_accounts_geocoded.csv. Reading local data file
2024-09-13 22:20:13,987 - fastrak_geocoding - INFO - Reading geocoded data from /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/bay_area_fastrak_accounts_geocoded.csv
2024-09-13 22:20:20,059 - fastrak_geocoding - INFO - Read 1010430 records from geocoded data
2024-09-13 22:20:20,096 - fastrak_geocoding - INFO - Read 1010430 records from geocoded data
2024-09-13 22:20:20,096 - fastrak_geocoding - INFO - Reading tract data from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/region_2020_censustract/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-13 22:20:23,599 - fastrak_geocoding - INFO - Read 1772 records from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/region_2020_censustract/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-13 22:20:23,599 - fastrak_geocoding - INFO - Reading EPC data from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/draft_equity_priority_communities_pba2050plus_acs2022a/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-13 22:20:24,778 - fastrak_geocoding - INFO - Read 1765 records from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/draft_equity_priority_communities_pba2050plus_acs2022a/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-13 22:20:24,779 - fastrak_geocoding - INFO - Spatially joining geocoded Fastrak data with tract data. Fastrack gdf len: 1010430 Tract gdf len: 1772
2024-09-13 22:20:39,663 - fastrak_geocoding - INFO - Joined 1010430 records
2024-09-13 22:20:39,664 - fastrak_geocoding - INFO - Joining the sjoin tract and Fastrak data to EPC data. Sjoin Fastrak data: 1010430 EPC data: 1765
2024-09-13 22:20:39,952 - fastrak_geocoding - INFO - Joined 1010430 records
2024-09-13 22:20:40,043 - fastrak_geocoding - INFO - Flagging matches. Only a match if geometry_location_type in: [ROOFTOP, 'RANGE_INTERPOLATED] and partial_match = False
2024-09-13 22:20:40,116 - fastrak_geocoding - INFO - Flagged {1: 978556, 0: 31874} records as matches
2024-09-13 22:20:40,116 - fastrak_geocoding - INFO - Flagging data within the region
2024-09-13 22:20:40,128 - fastrak_geocoding - INFO - Flagged {1: 1008588, 0: 1842} records within the region
2024-09-13 22:20:40,132 - fastrak_geocoding - INFO - Dropping records that are not matches and not in region. Drop count: 996
2024-09-13 22:20:40,280 - fastrak_geocoding - INFO - Dropping unnecessary columns: ['geometry_location_type', 'types', 'partial_match', 'index_right']
2024-09-13 22:20:40,390 - fastrak_geocoding - INFO - Dropping duplicates from geocoded data
2024-09-13 22:20:40,617 - fastrak_geocoding - INFO - Dropping columns that are not in the required columns list ['Is Duplicate Row?', 'Table Names', 'F4', 'ACCTNO', 'ACCTTYPE', 'ACCTSTATUS', 'ADDR', 'CITY', 'STATE', 'ZIP_CODE', 'ADDRESS', 'TX_DATE', 'PLAZA', 'TOLLCNT', 'VEHCOUNT', 'TAGCOUNT', 'Jurisdiction', 'NAMELSAD20', 'FULL_ADDRESS']
2024-09-13 22:20:41,105 - fastrak_geocoding - INFO - Joining the original Fastrak data to the joined data. Joined data: 965494 Original Fastrak data: 921649
2024-09-13 22:20:42,372 - fastrak_geocoding - INFO - Joined 921649 records
2024-09-13 22:20:42,413 - fastrak_geocoding - INFO - Updating columns ['epc_2050p', 'match', 'in_region'] to not null
2024-09-13 22:20:42,455 - fastrak_geocoding - INFO - Moving geometry column to the end
2024-09-13 22:20:43,177 - fastrak_geocoding - INFO - Fastrak data geocoded results: {1: 910843, 0: 10806}
2024-09-13 22:20:43,184 - fastrak_geocoding - INFO - Fastrak data in region results: {1: 919291, 0: 2358}
2024-09-13 22:20:43,190 - fastrak_geocoding - INFO - Fastrak data EPC results: {0: 765010, 1: 156639}
2024-09-13 22:20:43,277 - fastrak_geocoding - INFO - Writing final geocoded data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.geojson of length 921649
2024-09-13 22:20:43,277 - fastrak_geocoding - INFO - Only writing data with geometry
2024-09-13 22:21:23,896 - fastrak_geocoding - INFO - Wrote 921649 records to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.geojson
2024-09-13 22:21:23,896 - fastrak_geocoding - INFO - Writing final geocoded data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.csv of length 921649
2024-09-13 22:21:23,896 - fastrak_geocoding - INFO - Removing geometry column
2024-09-13 22:21:36,332 - fastrak_geocoding - INFO - Wrote 921649 records to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.csv
2024-09-13 22:21:36,562 - fastrak_geocoding - INFO - Summarizing the results for epc_data
2024-09-13 22:21:37,389 - fastrak_geocoding - INFO - Summarized geocoding results
2024-09-13 22:21:37,465 - fastrak_geocoding - INFO - Writing summary to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_summary.xlsx
2024-09-13 22:21:37,676 - fastrak_geocoding - INFO - Wrote summary to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_summary.xlsx
2024-09-13 22:21:37,772 - fastrak_geocoding - INFO - Aggregating geocoded data to the tract level
2024-09-13 22:21:37,772 - fastrak_geocoding - INFO - Filtering out records with match = 0 and in_region = 0 and null geometry
2024-09-13 22:21:38,281 - fastrak_geocoding - INFO - Aggregated to 1759 records
2024-09-13 22:21:38,282 - fastrak_geocoding - INFO - Joining aggregated data to EPC geodata: 1759 EPC data: 1765
2024-09-13 22:21:38,373 - fastrak_geocoding - INFO - Writing aggregated data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final_aggregated.geojson of length 1765
2024-09-13 22:21:38,616 - fastrak_geocoding - INFO - Wrote 1765 records to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final_aggregated.geojson
2024-09-13 22:21:38,617 - fastrak_geocoding - INFO - Writing aggregated data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final_aggregated.csv of length 1765
2024-09-18 10:58:30,844 - fastrak_geocoding - INFO - Reading Fastrak data from /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/account_complete_9_12_24.csv
2024-09-18 10:58:38,149 - fastrak_geocoding - INFO - Read 921649 records from Fastrak data
2024-09-18 10:58:38,149 - fastrak_geocoding - INFO - Dropping columns that are blank
2024-09-18 10:58:38,410 - fastrak_geocoding - INFO - Creating required columns for geocoding
2024-09-18 10:58:40,279 - fastrak_geocoding - INFO - Created FULL_ADDRESS column
2024-09-18 10:58:40,460 - fastrak_geocoding - INFO - Dropping 3007 duplicated addresses
2024-09-18 10:58:40,747 - fastrak_geocoding - INFO - Starting batch address geocoding on 918642 records
2024-09-18 10:58:40,747 - fastrak_geocoding - INFO - Local geocoded data file exists at /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/bay_area_fastrak_accounts_geocoded.csv. Reading local data file
2024-09-18 10:58:40,747 - fastrak_geocoding - INFO - Reading geocoded data from /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/bay_area_fastrak_accounts_geocoded.csv
2024-09-18 10:58:45,271 - fastrak_geocoding - INFO - Read 1010430 records from geocoded data
2024-09-18 10:58:45,305 - fastrak_geocoding - INFO - Read 1010430 records from geocoded data
2024-09-18 10:58:45,305 - fastrak_geocoding - INFO - Reading tract data from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/region_2020_censustract/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-18 10:58:50,428 - fastrak_geocoding - INFO - Read 1772 records from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/region_2020_censustract/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-18 10:58:50,428 - fastrak_geocoding - INFO - Reading EPC data from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/draft_equity_priority_communities_pba2050plus_acs2022a/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-18 10:58:52,069 - fastrak_geocoding - INFO - Read 1765 records from https://services3.arcgis.com/i2dkYWmb4wHvYPda/arcgis/rest/services/draft_equity_priority_communities_pba2050plus_acs2022a/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson
2024-09-18 10:58:52,071 - fastrak_geocoding - INFO - Spatially joining geocoded Fastrak data with tract data. Fastrack gdf len: 1010430 Tract gdf len: 1772
2024-09-18 10:59:05,236 - fastrak_geocoding - INFO - Joined 1010430 records
2024-09-18 10:59:05,236 - fastrak_geocoding - INFO - Joining the sjoin tract and Fastrak data to EPC data. Sjoin Fastrak data: 1010430 EPC data: 1765
2024-09-18 10:59:05,592 - fastrak_geocoding - INFO - Joined 1010430 records
2024-09-18 10:59:05,720 - fastrak_geocoding - INFO - Flagging matches. Only a match if geometry_location_type in: [ROOFTOP, 'RANGE_INTERPOLATED] and partial_match = False
2024-09-18 10:59:05,786 - fastrak_geocoding - INFO - Flagged {1: 978556, 0: 31874} records as matches
2024-09-18 10:59:05,787 - fastrak_geocoding - INFO - Flagging data within the region
2024-09-18 10:59:05,797 - fastrak_geocoding - INFO - Flagged {1: 1008588, 0: 1842} records within the region
2024-09-18 10:59:05,804 - fastrak_geocoding - INFO - Dropping records that are not matches and not in region. Drop count: 996
2024-09-18 10:59:06,035 - fastrak_geocoding - INFO - Dropping unnecessary columns: ['geometry_location_type', 'types', 'partial_match', 'index_right']
2024-09-18 10:59:06,177 - fastrak_geocoding - INFO - Dropping duplicates from geocoded data
2024-09-18 10:59:06,462 - fastrak_geocoding - INFO - Dropping columns that are not in the required columns list ['Is Duplicate Row?', 'Table Names', 'F4', 'ACCTNO', 'ACCTTYPE', 'ACCTSTATUS', 'ADDR', 'CITY', 'STATE', 'ZIP_CODE', 'ADDRESS', 'TX_DATE', 'PLAZA', 'TOLLCNT', 'VEHCOUNT', 'TAGCOUNT', 'Jurisdiction', 'NAMELSAD20', 'FULL_ADDRESS']
2024-09-18 10:59:06,957 - fastrak_geocoding - INFO - Joining the original Fastrak data to the joined data. Joined data: 965494 Original Fastrak data: 921649
2024-09-18 10:59:08,506 - fastrak_geocoding - INFO - Joined 921649 records
2024-09-18 10:59:08,545 - fastrak_geocoding - INFO - Updating columns ['epc_2050p', 'match', 'in_region'] to not null
2024-09-18 10:59:08,578 - fastrak_geocoding - INFO - Moving geometry column to the end
2024-09-18 10:59:09,404 - fastrak_geocoding - INFO - Fastrak data geocoded results: {1: 910843, 0: 10806}
2024-09-18 10:59:09,411 - fastrak_geocoding - INFO - Fastrak data in region results: {1: 919291, 0: 2358}
2024-09-18 10:59:09,419 - fastrak_geocoding - INFO - Fastrak data EPC results: {0: 765010, 1: 156639}
2024-09-18 10:59:09,504 - fastrak_geocoding - INFO - Writing final geocoded data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.geojson excluding records without geometry.
2024-09-18 11:02:25,384 - fastrak_geocoding - INFO - Wrote 920117 records to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.geojson
2024-09-18 11:02:25,385 - fastrak_geocoding - INFO - Writing final geocoded data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.csv including all records
2024-09-18 11:02:25,385 - fastrak_geocoding - INFO - Removing geometry column
2024-09-18 11:02:36,329 - fastrak_geocoding - INFO - Wrote 921649 records to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final.csv
2024-09-18 11:02:36,630 - fastrak_geocoding - INFO - Summarizing the results for epc_data
2024-09-18 11:02:37,682 - fastrak_geocoding - INFO - Summarized geocoding results
2024-09-18 11:02:37,757 - fastrak_geocoding - INFO - Writing summary to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_summary.xlsx
2024-09-18 11:02:38,076 - fastrak_geocoding - INFO - Wrote summary to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_summary.xlsx
2024-09-18 11:02:38,247 - fastrak_geocoding - INFO - Aggregating geocoded data to the tract level
2024-09-18 11:02:38,247 - fastrak_geocoding - INFO - Filtering out records with match = 0 and in_region = 0 and null geometry
2024-09-18 11:02:38,772 - fastrak_geocoding - INFO - Aggregated to 1759 records
2024-09-18 11:02:38,773 - fastrak_geocoding - INFO - Joining aggregated data to EPC geodata: 1759 EPC data: 1765
2024-09-18 11:02:38,858 - fastrak_geocoding - INFO - Writing aggregated data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final_aggregated.geojson of length 1765
2024-09-18 11:02:39,470 - fastrak_geocoding - INFO - Wrote 1765 records to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final_aggregated.geojson
2024-09-18 11:02:39,470 - fastrak_geocoding - INFO - Writing aggregated data to /Users/jcroff/Library/CloudStorage/Box-Box/DataViz Projects/Data Services/FasTrak Data/Fastrak Accounts Cleaned/Final Geocode Results/bay_area_fastrak_accounts_geocoded_final_aggregated.csv of length 1765
